using System.Text.Json.Serialization;
using SharpStix.Common;
using SharpStix.Serialisation.Json.Converters;
using SharpStix.Services;

namespace SharpStix.StixTypes.Vocabulary;

[JsonConverter(typeof(StixOpenVocabConverter<MalwareCapabilities>))]
[StixTypeDiscriminator(TYPE)]
public sealed record MalwareCapabilities : StixOpenVocab, IFromString<MalwareCapabilities>
{
    private const string TYPE = "malware-capabilities-ov";

    public static readonly MalwareCapabilities AccessesRemoteMachines =
        FromString("accesses-remote-machines");

    public static readonly MalwareCapabilities AntiDebugging = FromString("anti-debugging");

    public static readonly MalwareCapabilities AntiDisassembly = FromString("anti-disassembly");

    public static readonly MalwareCapabilities AntiEmulation = FromString("anti-emulation");

    public static readonly MalwareCapabilities AntiMemoryForensics = FromString("anti-memory-forensics");

    public static readonly MalwareCapabilities AntiSandbox = FromString("anti-sandbox");

    public static readonly MalwareCapabilities AntiVirtualisation = FromString("anti-vm");

    public static readonly MalwareCapabilities CapturesInputPeripherals =
        FromString("captures-input-peripherals");

    public static readonly MalwareCapabilities CapturesOutputPeripherals =
        FromString("captures-output-peripherals");

    public static readonly MalwareCapabilities CapturesSystemStateData =
        FromString("captures-system-state-data");

    public static readonly MalwareCapabilities CleansTracesOfInfection =
        FromString("cleans-traces-of-infection");

    public static readonly MalwareCapabilities CommitsFraud = FromString("commits-fraud");

    public static readonly MalwareCapabilities CommunicatesWithC2 = FromString("communicates-with-c2");

    public static readonly MalwareCapabilities CompromisesDataAvailability =
        FromString("compromises-data-availability");

    public static readonly MalwareCapabilities CompromisesDataIntegrity =
        FromString("compromises-data-integrity");

    public static readonly MalwareCapabilities CompromisesSystemAvailability =
        FromString("compromises-system-availability");

    public static readonly MalwareCapabilities ControlsLocalMachine = FromString("controls-local-machine");

    public static readonly MalwareCapabilities DegradesSecuritySoftware =
        FromString("degrades-security-software");

    public static readonly MalwareCapabilities DegradesSystemUpdates =
        FromString("degrades-system-updates");

    public static readonly MalwareCapabilities DeterminesC2Server = FromString("determines-c2-server");

    public static readonly MalwareCapabilities EmailsSpam = FromString("emails-spam");

    public static readonly MalwareCapabilities EscalatesPrivileges = FromString("escalates-privileges");

    public static readonly MalwareCapabilities EvadesAntiVirus = FromString("evades-av");

    public static readonly MalwareCapabilities ExfiltratesData = FromString("exfiltrates-data");

    public static readonly MalwareCapabilities FingerprintsHost = FromString("fingerprints-host");

    public static readonly MalwareCapabilities HidesArtefacts = FromString("hides-artifacts");

    public static readonly MalwareCapabilities HidesExecutingCode = FromString("hides-executing-code");

    public static readonly MalwareCapabilities InfectsFiles = FromString("infects-files");

    public static readonly MalwareCapabilities InfectsRemoteMachines =
        FromString("infects-remote-machines");

    public static readonly MalwareCapabilities InstallsOtherComponents =
        FromString("installs-other-components");

    public static readonly MalwareCapabilities PersistsAfterSystemReboot =
        FromString("persists-after-system-reboot");

    public static readonly MalwareCapabilities PreventsArtifactAccess =
        FromString("prevents-artifact-access");

    public static readonly MalwareCapabilities PreventsArtifactDeletion =
        FromString("prevents-artifact-deletion");

    public static readonly MalwareCapabilities ProbesNetworkEnvironment =
        FromString("probes-network-environment");

    public static readonly MalwareCapabilities SelfModifies = FromString("self-modifies");

    public static readonly MalwareCapabilities StealsAuthenticationCredentials =
        FromString("steals-authentication-credentials");

    public static readonly MalwareCapabilities ViolatesSystemOperationalIntegrity =
        FromString("violates-system-operational-integrity");

    private MalwareCapabilities(string Value) : base(Value)
    {
    }

    public override string Type => TYPE;

    public static MalwareCapabilities FromString(string value)
    {
        if (OpenVocabManager<MalwareCapabilities>.TryGetValue(value, out MalwareCapabilities? vocab))
            return vocab!;

        vocab = new MalwareCapabilities(value);
        OpenVocabManager<MalwareCapabilities>.TryAdd(vocab);
        return vocab;
    }

    public override string ToString() => base.ToString();
}