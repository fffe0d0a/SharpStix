using SharpStix.Services;
using SharpStix.StixTypes;
using SharpStix.StixTypes.Vocabulary;

namespace SharpStix.StixObjects.Domain;

[StixTypeDiscriminator(TYPE)]
public sealed record Malware : DomainObject
{
    private const string TYPE = "malware";

    /// <summary>
    ///     A name used to identify the malware instance or family, as specified by the producer of the SDO. For a malware
    ///     family the name MUST be defined. If a name for a malware instance is not available, the SHA-256 hash value or
    ///     sample’s filename MAY be used instead.
    /// </summary>
    public string? Name { get; init; }

    /// <summary>
    ///     A description that provides more details and context about the malware instance or family, potentially including
    ///     its purpose and its key characteristics.
    /// </summary>
    public string? Description { get; init; }

    /// <summary>
    ///     A set of categorizations for the malware being described.
    /// </summary>
    public StixList<MalwareType>? MalwareTypes { get; init; }

    /// <summary>
    ///     Whether the object represents a malware family (if true) or a malware instance (if false).
    /// </summary>
    public required bool IsFamily { get; init; }

    /// <summary>
    ///     Alternative names used to identify this malware or malware family.
    /// </summary>
    public StixList<string>? Aliases { get; init; }

    /// <summary>
    ///     The list of Kill Chain Phases for which this malware can be used.
    /// </summary>
    public StixList<StixKillChainPhase>? KilledChainPhases { get; init; }

    /// <summary>
    ///     The time that the malware instance or family was first seen.
    /// </summary>
    public DateTime? FirstSeen { get; init; }

    /// <summary>
    ///     The time that the malware family or malware instance was last seen.
    /// </summary>
    public DateTime? LastSeen { get; init; }

    /// <summary>
    ///     The operating systems that the malware family or malware instance is executable on. This applies to virtualized
    ///     operating systems as well as those running on bare metal.
    /// </summary>
    public StixList<StixIdentifier>? OperatingSystemRefs { get; init; }

    /// <summary>
    ///     The processor architectures (e.g., x86, ARM, etc.) that the malware instance or family is executable on.
    /// </summary>
    public StixList<ProcessorArchitecture>? ArchitectureExecutionEnvs { get; init; }

    /// <summary>
    ///     The programming language(s) used to implement the malware instance or family.
    /// </summary>
    public StixList<ImplementationLanguage>? ImplementationLanguages { get; init; }

    /// <summary>
    ///     Any of the capabilities identified for the malware instance or family.
    /// </summary>
    public StixList<MalwareCapabilities>? Capabilities { get; init; }

    /// <summary>
    ///     The sample_refs property specifies a list of identifiers of the SCO file or artifact objects associated with this
    ///     malware instance(s) or family.
    /// </summary>
    public StixList<StixIdentifier>? SampleRefs { get; init; }

    public override string Type => TYPE;
}